package app

import "github.com/cufee/shopping-list/prisma/db"
import "github.com/cufee/shopping-list/internal/templates/componenets"
import "github.com/cufee/shopping-list/internal/templates/componenets/common"
import "fmt"

type List struct {
	List  *db.ListModel
	Group *db.GroupModel
	Items []db.ListItemModel
}

templ (props List) Render() {
	@components.PageHeader(components.BreadcrumbsTitle(
		[]components.BreadCrumb{
			{Label: "Groups", Href: "/app"},
			{Label: props.Group.Name, Href: fmt.Sprintf("/app/group/%s", props.List.GroupID)},
			{Label: props.List.Name},
		},
	), components.WithDescription(props.List.Desc), manageListButton(props.Group.ID, props.List.ID))
	<div class="divider"></div>
	<div class="flex flex-col gap-4">
		<div id="list-items" class="flex flex-col gap-1">
			for _, item := range props.Items {
				@components.ListItem{Item: &item, GroupID: props.Group.ID}.Render()
			}
		</div>
		@components.NewListItem(props.List.GroupID, props.List.ID, "#list-items", nil, nil)
	</div>
}

templ manageListButton(groupId, listId string) {
	<div>
		<div class="tooltip tooltip-left" data-tip="Manage List">
			<a href={ templ.URL(fmt.Sprintf("/app/group/%s/list/%s/manage", groupId, listId)) } hx-boost="true">
				@common.Button("btn-square").Neutral() {
					@components.IconCog()
				}
			</a>
		</div>
	</div>
}
